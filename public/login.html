<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SOC - Login</title>
    <link rel="stylesheet" href="css/login.css">
</head>
<body>
    <!-- FORMULÁRIO DE LOGIN -->
    <div class="login-box" id="login-form">
        <h2>Entrar no SOC</h2>
        <input type="email" id="email" placeholder="E-mail" required>
        <input type="password" id="senha" placeholder="Senha" required>
        <button onclick="login()">Entrar</button>
        <p>--- OU ---</p>
        <button onclick="abrirPopupCadastro()">Registrar-se</button>
    </div>

    <!-- POP-UP DE CADASTRO -->
    <div id="popup-cadastro" class="popup">
        <div class="popup-conteudo" id="popup-arrastavel">
            <div class="popup-cabecalho" id="popup-cabecalho">
                <h2>Registrar-se</h2>
                <button class="fechar-popup" onclick="fecharPopup()" title="Fechar">&times;</button>
            </div>
            <input type="text" id="nome-usuario" placeholder="Nome de usuário" required>
            <input type="email" id="email-cadastro" placeholder="E-mail" required>
            <input type="password" id="senha-cadastro" placeholder="Senha" required>
            <input type="password" id="confirmar-senha" placeholder="Confirmar senha" required>
            <input type="tel" id="telefone" placeholder="Número de telefone (opcional)">
            <button onclick="validarCadastro()">Criar Conta</button>
        </div>
    </div>

    <!-- FIREBASE + LÓGICA -->
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.1/firebase-firestore.js"></script>
    <script>
        // Configuração do Firebase (substitua pelos seus dados) 
        // AJSDLAKSJDLAK ACHO QUE NAO É MTO LEGAL DEIXAR ESSAS INFO PUBLICA, melhor jogar tudo num .env
       const firebaseConfig = {
  apiKey: "AIzaSyBGrbgtGl-tMsbgOjgiw2Bkf1Ygv7th_so",
  authDomain: "saymonkim-28655.firebaseapp.com",
  projectId: "saymonkim-28655",
  storageBucket: "saymonkim-28655.firebasestorage.app",
  messagingSenderId: "501384829136",
  appId: "1:501384829136:web:7cbdab42b3884b4f2b66d5",
  measurementId: "G-EPW52M4MTR"
};
        firebase.initializeApp(firebaseConfig);

        // ===== FUNÇÕES DE LOGIN =====
        function login() {
            const email = document.getElementById("email").value;
            const senha = document.getElementById("senha").value;
            
            firebase.auth().signInWithEmailAndPassword(email, senha)
                .then(() => window.location.href = "mural.html")
                .catch((error) => alert("Erro: " + error.message));
        }

        // ===== FUNÇÕES DO POP-UP =====
        function abrirPopupCadastro() {
            document.getElementById("popup-cadastro").style.display = "block";
        }

        function fecharPopup() {
            document.getElementById("popup-cadastro").style.display = "none";
        }

        // ===== VALIDAÇÃO DE CADASTRO =====
        function validarCadastro() {
            const nome = document.getElementById("nome-usuario").value;
            const email = document.getElementById("email-cadastro").value;
            const senha = document.getElementById("senha-cadastro").value;
            const confirmarSenha = document.getElementById("confirmar-senha").value;
            const telefone = document.getElementById("telefone").value;

            // Validações
            if (senha !== confirmarSenha) {
                alert("As senhas não coincidem!");
                return;
            }

            if (senha.length < 6) {
                alert("A senha deve ter pelo menos 6 caracteres!");
                return;
            }

            // Cadastro no Firebase
            firebase.auth().createUserWithEmailAndPassword(email, senha)
                .then((userCredential) => {
                    // Salva dados adicionais no Firestore
                    firebase.firestore().collection("usuarios").doc(userCredential.user.uid).set({
                        nome: nome,
                        email: email,
                        telefone: telefone || null,
                        dataCadastro: new Date()
                    });
                    
                    alert("Cadastro realizado com sucesso!");
                    fecharPopup();
                    window.location.href = "mural.html";
                })
                .catch((error) => {
                    alert("Erro: " + error.message);
                });
        }

        // ===== ARRASTAR POP-UP =====
        const popupCabecalho = document.getElementById("popup-cabecalho");
        const popup = document.getElementById("popup-arrastavel");
        
        let posX = 0, posY = 0, mouseX = 0, mouseY = 0;
        
        popupCabecalho.addEventListener('mousedown', function(e) {
            e.preventDefault();
            mouseX = e.clientX;
            mouseY = e.clientY;
            document.addEventListener('mousemove', moverPopup);
            document.addEventListener('mouseup', function() {
                document.removeEventListener('mousemove', moverPopup);
            });
        });
        
        function moverPopup(e) {
            posX = mouseX - e.clientX;
            posY = mouseY - e.clientY;
            mouseX = e.clientX;
            mouseY = e.clientY;
            
            popup.style.top = (popup.offsetTop - posY) + "px";
            popup.style.left = (popup.offsetLeft - posX) + "px";
            popup.style.transform = "none";
        }
    </script>
</body>
</html>
